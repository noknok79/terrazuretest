resource "azurerm_key_vault_key" "additional_keys" {
  name         = "1st-addons-key"
  key_vault_id = module.keyvault.keyvault_id
  key_type     = "RSA"
  key_size     = 2048
  key_opts     = ["encrypt", "decrypt", "sign", "verify", "wrapKey", "unwrapKey"]
  tags         = {
    environment = var.keyvault_config.environment
    owner       = var.keyvault_config.owner
  }
}

resource "azurerm_key_vault_secret" "additional_secrets" {
  name         = "1st-addons-secret"
  value        = "my-secret-value"
  key_vault_id = module.keyvault.keyvault_id
  tags         = {
    environment = var.keyvault_config.environment
    owner       = var.keyvault_config.owner
  }
}

resource "azurerm_key_vault_certificate" "additional_certificates" {
  name         = "1st-addons-certificate"
  key_vault_id = module.keyvault.keyvault_id
  certificate_policy {
    issuer_parameters {
      name = "Self"
    }
    key_properties {
      exportable = true
      key_size   = 2048
      key_type   = "RSA"
      reuse_key  = true
    }
    secret_properties {
      content_type = "application/x-pkcs12"
    }
    x509_certificate_properties {
      subject            = "CN=example.com"
      validity_in_months = 12
      key_usage = [
        "digitalSignature",
        "keyEncipherment",
      ]
    }
  }
  tags = {
    environment = var.keyvault_config.environment
    owner       = var.keyvault_config.owner
  }
}